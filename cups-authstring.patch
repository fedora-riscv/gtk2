Index: configure.in
===================================================================
--- configure.in	(revision 18526)
+++ configure.in	(working copy)
@@ -1572,6 +1572,15 @@
 fi
 AM_CONDITIONAL(HAVE_CUPS, test "x$CUPS_CONFIG" != "xno")
 
+gtk_save_cflags="$CFLAGS"
+CFLAGS="$CUPS_CFLAGS"
+AC_TRY_COMPILE([#include <cups/http.h>],
+               [http_t http; char *s = http.authstring;],
+               [AC_DEFINE(HAVE_HTTP_AUTHSTRING,[],[Define if cups http_t authstring field is accessible])],)
+CFLAGS="$gtk_save_cflags"
+
+AC_SUBST(HAVE_HTTP_AUTHSTRING)
+
 gtk_save_cppflags="$CPPFLAGS"
 CPPFLAGS="$CPPFLAGS $GTK_DEP_CFLAGS"
 			  
Index: modules/printbackends/cups/gtkcupsutils.c
===================================================================
--- modules/printbackends/cups/gtkcupsutils.c	(revision 18526)
+++ modules/printbackends/cups/gtkcupsutils.c	(working copy)
@@ -30,10 +30,6 @@
 #include <stdlib.h>
 #include <time.h>
 
-#if CUPS_VERSION_MAJOR > 1 || (CUPS_VERSION_MAJOR == 1 && CUPS_VERSION_MINOR > 1) || (CUPS_VERSION_MAJOR == 1 && CUPS_VERSION_MINOR == 1 && CUPS_VERSION_PATCH >= 20)
-#define HAVE_HTTP_AUTHSTRING 1
-#endif
-
 typedef void (*GtkCupsRequestStateFunc) (GtkCupsRequest *request);
 
 static void _connect            (GtkCupsRequest *request);
