--- modules/printbackends/cups/gtkprintbackendcups.c	2008-09-08 12:07:55.000000000 +0200
+++ modules/printbackends/cups/gtkprintbackendcups.c	2008-09-08 13:11:58.000000000 +0200
@@ -1181,6 +1181,7 @@ cups_request_printer_list_cb (GtkPrintBa
 	  char hostname[HTTP_MAX_URI];	/* Hostname */
 	  char resource[HTTP_MAX_URI];	/* Resource name */
 	  int  port;			/* Port number */
+	  char *cups_server;            /* CUPS server */
 	  
           list_has_changed = TRUE;
 	  cups_printer = gtk_printer_cups_new (printer_name, backend);
@@ -1227,9 +1228,20 @@ cups_request_printer_list_cb (GtkPrintBa
             }
 
 	  gethostname (uri, sizeof (uri));
+	  cups_server = g_strdup (cupsServer());
+
 	  if (strcasecmp (uri, hostname) == 0)
 	    strcpy (hostname, "localhost");
 
+          /* if the cups server is local and listening at a unix domain socket 
+           * then use the socket connection
+           */
+	  if ((strstr (hostname, "localhost") != NULL) &&
+	      (cups_server[0] == '/'))
+	    strcpy (hostname, cups_server);
+
+	  g_free (cups_server);
+
 	  cups_printer->hostname = g_strdup (hostname);
 	  cups_printer->port = port;
 	  
